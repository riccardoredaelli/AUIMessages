<!DOCTYPE html>
<head>
<title>Wivr</title>
<script src="https://rawgit.com/aframevr/aframe/master/dist/aframe-master.min.js"></script> 
<script src="https://unpkg.com/aframe-curve-component/dist/aframe-curve-component.min.js"></script> 
<script src="js/collidable.js"></script>
<script src="js/three.js"></script>
</head>
 
<body>
  <a-scene id="scene">
    <a-camera>
        <a-cursor></a-cursor>
         <a-entity id='rc' laser-controls raycaster="objects: .clickable ; showLine: true; interval:10" position='0 0 0'material='color: red'></a-entity>
    </a-camera>
    <a-sky id='sky' color='white'></a-sky>
    <a-entity id='path' class='clickable' >
        <a-cylinder  id="cylinder" position="-2 0 -4" radius="0.8" height="5" rotation='0 0 90' color='green'></a-cylinder>
        <a-cylinder id="cylinder1" position="2 0 -4" radius="0.8" height="5" rotation='0 0 90' color='yellow'></a-cylinder>   
    </a-entity>
  </a-scene>
    <script>
        var scene=document.querySelector('#scene');
        var sky=document.querySelector('#sky');
        var rc=document.querySelector('#rc');
        var path= new Array('cylinder', 'cylinder1');
        var intersected= new Array();
        
        rc.addEventListener('raycaster-intersection', function(evt){
            console.log('lunghezza= ' + evt.detail.els.length);
            var len=evt.detail.els.length;
            for(var i=0 ; i< len ; i++){
                intersected[i]=evt.detail.els[i];
            }
            sky.setAttribute('color','black'); 
        });
        
        
        rc.addEventListener('raycaster-intersection-cleared', function(evt){
            console.log('lunghezza=' + intersected.length);
            console.log('elemento a cui tolgo intersezione = ' + evt.detail.el);
            var index;
            for(var i=0 ; i<intersected.length; i++){
                if (intersected[i].getAttribute('id')==e.detail.el.getAttribute('id'))
                    index=i;
            }
            delete intersected[index];
            if(intersected.length){
                sky.setAttribute('color', 'white');
            }
            else return;
        });
           
       
        
    </script>
</body>